<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>app.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>app.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-&lt;em&gt;Week_04:_We_return_with_more_Sinatra._Introducing_templates,_stylesheets_and_javascripts.&lt;/em&gt;'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-&lt;em&gt;Week_04:_We_return_with_more_Sinatra._Introducing_templates,_stylesheets_and_javascripts.&lt;/em&gt;">&#182;</a>
        </div>
        <h4><em>Week 04: We return with more Sinatra. Introducing templates, stylesheets and javascripts.</em></h4>

<h4><em>Part of <a href="http://itpwebdev.github.com">ITP Web Dev Workshop</a></em></h4>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-2">&#182;</a>
        </div>
        <p>Last time we introduce you to <a href="http://www.sinatrarb.com">Sinatra</a>,
if you don&rsquo;t remember, head on over to
<a href="http://itpwebdev.github.com/03-Intro-To-Ruby---HTTP/">Lesson 3</a></p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>We&rsquo;re on our way to a <a href="http://en.wikipedia.org/wiki/Model–view–controller">Model View Controller</a>
architecture. Last week we covered the <em>Controller</em> last time but
we didn&rsquo;t really mention it. A <em>Controller</em> for our purposes is a
url, and we write this with Sinatra with</p>

<pre><code>get &lsquo;/&rsquo; do
  # CONTROLLER CODE
end
</code></pre>

<p>This week we&rsquo;re getting in to the other two parts, Views and Models.
Views are what is shown. Controllers call on Views. A webpage is a
view and the url is a representation of the controller. We&rsquo;ll get in
to this more further down.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>First we need to set up the app, just like last time we tell Ruby to 
look at our gems and then get the Sinatra gem.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;sinatra&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>And our root controller <code>&lsquo;/&rsquo;</code>. This controller takes the user input
and deciphers it to respond with a view.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">get</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span></pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-6">&#182;</a>
        </div>
        <p>Let&rsquo;s show the user the current time, for this we&rsquo;ll use an instance
variable. Instance variables are super variables. They are local to
Sinatra, not to a specific file so we can use them between the controller
and the view.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="vi">@time</span> <span class="o">=</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <p>Instead of just putting the time on the page, let&rsquo;s use the attributes
of the time (minutes, hours, date) to create a colored div.
Also, let&rsquo;s give our site a Title</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="vi">@title</span> <span class="o">=</span> <span class="s2">&quot;ITP Web Dev Presents Colored Boxes&quot;</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-8">&#182;</a>
        </div>
        <p>Here we call our template with the method <code>erb</code>. Erb is a templating
system for Ruby. Templates allow us to have only a few pages and fill
them in with dynamic data.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  </pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-9">&#182;</a>
        </div>
        <p>So <code>erb</code> is the method and as an argument I&rsquo;m passing in <code>:main</code> which
is understood to be a file named <code>main.erb</code>. (More on this later.)</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">erb</span> <span class="ss">:main</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-10'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-10">&#182;</a>
        </div>
        <p>Now if we start up the application (in Terminal <code>cd</code> to the appropriate
directory) with</p>

<pre><code>$ ruby app.rb
</code></pre>

<p>And point our browser to <code>http://localhost:4567/</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p>What the blazes! It looks like a webpage. What&rsquo;s going on?
If you look at the <code>views/</code> folder you&rsquo;ll see 2 files (you might see more
but focus on these 2): <code>layout.erb</code> and <code>main.erb</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-12">&#182;</a>
        </div>
        <p>Open up <code>layout.erb</code>, if you don&rsquo;t want to do that, here it is:</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
   &lt;head&gt;
     &lt;title&gt;&lt;%= @title %&gt;&lt;/title&gt;
     &lt;link rel=&ldquo;stylesheet&rdquo; href=&ldquo;style.css&rdquo;/&gt;
   &lt;/head&gt;
   &lt;body&gt;
     &lt;div id=&ldquo;wrapper&rdquo;&gt;
       &lt;h1&gt;&lt;%= @title %&gt;&lt;/h1&gt;
       &lt;%= yield %&gt;
     &lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
</code></pre>

<p>It looks mostly like HTML except for the <code>&lt;%= %&gt;</code> bits right?
Good, because it is just like HTML except for those bits. Inside of 
these tags goes Ruby code. There are two varieties:</p>

<p><strong>Inline Code</strong> Ruby inside of these tags is processed but does not
render to the page</p>

<pre><code>&lt;% %&gt;
</code></pre>

<p><strong>Rendered Code</strong> The results of the Ruby code inside these tags is
rendered to the document</p>

<pre><code>&lt;%= %&gt;
</code></pre>

<p>So with this knowledge we see that <code>&lt;%= @title %&gt;</code> is going to print
out the value of the <code>@title</code> variable in the document.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-13'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-13">&#182;</a>
        </div>
        <p>There&rsquo;s one other bit, <code>&lt;%= yield %&gt;</code>. This is a method that tells Erb
to put the contents of whatever erb file we asked for in place of <code>yield</code>.
So right now that means the contents of <code>main.erb</code> is getting put in place
of <code>yield</code> since we asked for <code>erb :main</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-14'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-14">&#182;</a>
        </div>
        <p>Something I didn&rsquo;t explain, this file <code>layout.erb</code> is pulled up by Erb
every time we call <code>erb</code>. So if you open up <code>main.erb</code> you&rsquo;ll notice there
are none of the HTML <code>head</code> elements, just the content. Awesome.</p>

      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
